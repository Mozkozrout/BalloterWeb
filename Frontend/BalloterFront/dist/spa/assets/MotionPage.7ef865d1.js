import{d as B,S as D,I as v,U as H,J as s,V as b,K as i,L as o,f as t,O as f,P as r,N as u,F as S,a6 as U,b7 as Q,b5 as $,a4 as h,a5 as n,X as p,a1 as F,b6 as M,Z as w,W as k,Y as P,b8 as J,M as j,a0 as K}from"./index.0f3dcf3a.js";import{Q as W,b as z}from"./QItem.39e6fcfe.js";import{Q as E}from"./QList.9eb0caa3.js";import{Q as N,a as X}from"./QInfiniteScroll.d520ebd6.js";import{Q as Z,a as G}from"./QExpansionItem.ff0480a7.js";import{Q as d,a as Y}from"./QSkeleton.953fdc16.js";import{u as O}from"./BallotStore.5b1c0dbb.js";import{Q as y}from"./QChip.ab755d56.js";const R=B({name:"MotionList",props:["motionList"],methods:{onEditClick(e){this.$q.dialog({title:this.$t("motion.list.edit.title"),message:this.$t("motion.list.edit.message"),prompt:{model:e.name,type:"text"},persistent:!1,ok:{flat:!0,color:"light-blue-13",label:this.$t("motion.list.edit.button.ok")},cancel:{flat:!0,color:"orange-13",label:this.$t("motion.list.edit.button.cancel")}}).onOk(async l=>{this.authStore.user!=null&&this.authStore.user.person!=null&&this.authStore.user.person.id!=e.added_by.id?this.$dialogs.unauthorized():await this.ballotStore.editMotion(e,l)?this.$q.notify({icon:"done",color:"positive",message:this.$t("motion.list.edit.success")}):this.$q.notify({icon:"warning",color:"negative",message:this.$t("motion.list.edit.failure")})})},onDeleteClick(e){this.$q.dialog({title:this.$t("motion.list.delete.title"),message:this.$t("motion.list.delete.message"),persistent:!0,ok:{flat:!0,color:"negative",label:this.$t("motion.list.delete.button.ok")},cancel:{flat:!0,color:"light-blue-13",label:this.$t("motion.list.delete.button.cancel")}}).onOk(async()=>{this.authStore.user!=null&&this.authStore.user.person!=null&&this.authStore.user.person.id!=e.added_by.id?this.$dialogs.unauthorized():await this.ballotStore.deleteMotion(e)?this.$q.notify({icon:"done",color:"positive",message:this.$t("motion.list.delete.warning.success")}):this.$q.notify({icon:"warning",color:"negative",message:this.$t("motion.list.delete.failure")})})}},computed:{...D(H,O)}}),x={class:"row"};function ee(e,l,g,C,L,c){return s(),b(S,null,[e.motionList.length==0?(s(),i(z,{key:0},{default:o(()=>[t(W,{class:"text-subtitle1"},{default:o(()=>[f(r(e.$t("motion.list.empty")),1)]),_:1})]),_:1})):u("",!0),(s(!0),b(S,null,U(e.motionList,(a,q)=>{var m,_,A;return s(),i(Z,{key:q,label:a.name,"header-class":{"text-subtitle2":a.added_by.id!==((m=e.authStore.user)==null?void 0:m.person.id),"text-subtitle2 text-light-blue-13":a.added_by.id===((_=e.authStore.user)==null?void 0:_.person.id),"text-subtitle2 text-lime-6":e.$q.dark.isActive&&a.added_by.id===((A=e.authStore.user)==null?void 0:A.person.id)}},{default:o(()=>[t(Q,null,{default:o(()=>{var I,V;return[t($,null,{default:o(()=>[h("div",x,[t(y,{class:n({"bg-white":!e.$q.dark.isActive})},{default:o(()=>[e.$q.dark.isActive?(s(),i(p,{key:0,icon:"person",color:"light-blue-13"})):(s(),i(p,{key:1,icon:"person",color:"lime-6"})),f(" "+r(e.$t("motion.list.addedBy"))+" "+r(a.added_by.name)+" "+r(a.added_by.surname),1)]),_:2},1032,["class"]),a.edited_by!==null?(s(),i(y,{key:0,class:n({"bg-white":!e.$q.dark.isActive})},{default:o(()=>[e.$q.dark.isActive?(s(),i(p,{key:0,icon:"engineering",color:"light-blue-13"})):(s(),i(p,{key:1,icon:"engineering",color:"lime-6"})),f(" "+r(e.$t("motion.list.editedBy"))+" "+r(a.edited_by.name)+" "+r(a.edited_by.surname),1)]),_:2},1032,["class"])):u("",!0),t(y,{class:n({"bg-white":!e.$q.dark.isActive})},{default:o(()=>[e.$q.dark.isActive?(s(),i(p,{key:0,icon:"calendar_month",color:"light-blue-13"})):(s(),i(p,{key:1,icon:"calendar_month",color:"lime-6"})),f(" "+r(e.$t("motion.list.createdAt"))+" "+r(new Date(a.created_at).toLocaleDateString()),1)]),_:2},1032,["class"]),a.updated_at!=null&&a.updated_at!==a.created_at?(s(),i(y,{key:1,class:n({"bg-white":!e.$q.dark.isActive})},{default:o(()=>[e.$q.dark.isActive?(s(),i(p,{key:0,icon:"edit_calendar",color:"light-blue-13"})):(s(),i(p,{key:1,icon:"edit_calendar",color:"lime-6"})),f(" "+r(e.$t("motion.list.editedAt"))+" "+r(new Date(a.updated_at).toLocaleDateString()),1)]),_:2},1032,["class"])):u("",!0)])]),_:2},1024),t(F,{inset:""}),((I=e.authStore.user)==null?void 0:I.person)!=null&&((V=e.authStore.user)==null?void 0:V.person.id)===a.added_by.id?(s(),i(M,{key:0},{default:o(()=>[t(w,{flat:"",class:"q-pa-sm",color:"orange-13",label:e.$t("motion.list.button.edit"),onClick:T=>e.onEditClick(a)},null,8,["label","onClick"]),t(w,{flat:"",class:"q-pa-sm",color:"negative",label:e.$t("motion.list.button.delete"),onClick:T=>e.onDeleteClick(a)},null,8,["label","onClick"])]),_:2},1024)):u("",!0)]}),_:2},1024)]),_:2},1032,["label","header-class"])}),128))],64)}var te=v(R,[["render",ee]]);const se=B({name:"MotionPageSkeleton",computed:{mobileW(){return this.$q.platform.is.mobile?this.$q.screen.width:this.$q.screen.width/2},mobileH(){return this.$q.platform.is.mobile?this.$q.screen.height-50:250}}}),oe={id:"Motion Page Skeleton"},ie={class:"row"},ae={class:"row justify-center"};function le(e,l,g,C,L,c){return s(),b("div",oe,[t(Y,{class:"row justify-center items-center",style:{background:"linear-gradient(#f3f3f5, #b4b4b4)"}},{default:o(()=>[h("div",{class:n({"q-pa-lg":!e.$q.platform.is.mobile})},[h("div",ie,[t(Q,{square:"",style:k({minWidth:e.mobileW+"px",minHeight:e.mobileH+"px"})},{default:o(()=>[t($,null,{default:o(()=>[h("div",{class:n({"row justify-center":e.$q.screen.width>=650,"row justify-start":e.$q.screen.width<=650})},[h("div",ae,[t(d,{type:"rect",width:"100px",height:"50px"})]),t(d,{type:"rect",width:"200px",height:"50px",class:"q-ml-md absolute",style:{bottom:"0",right:"18px",transform:"translateY(-15px)"}})],2)]),_:1}),t($,null,{default:o(()=>[t(N,{offset:250,style:k([{"max-width":"1000px",overflow:"auto"},{height:e.$q.screen.height/2.2+"px"}]),class:"q-pa-md"},{default:o(()=>[t(E,{separator:"",bordered:"",class:"rounded-borders"},{default:o(()=>[t(d,{type:"QInput",class:"q-ma-sm"}),t(d,{type:"QInput",class:"q-ma-sm"}),t(d,{type:"QInput",class:"q-ma-sm"}),t(d,{type:"QInput",class:"q-ma-sm"}),t(d,{type:"QInput",class:"q-ma-sm"})]),_:1})]),_:1},8,["style"])]),_:1}),t(M,null,{default:o(()=>[t(d,{type:"QToggle",width:"100px",class:"q-ma-md"}),t(d,{type:"circle",size:"60px",class:"absolute",style:{bottom:"0",right:"18px",transform:"translateY(-18px)"}})]),_:1})]),_:1},8,["style"])])],2)]),_:1})])}var re=v(se,[["render",le]]);const ne={name:"MotionPage",components:{MotionList:te,MotionPageSkeleton:re},props:["user"],data:function(){return{searchInput:"",userMotion:!1}},mounted(){this.authStore.user===null&&this.$router.push({path:"/auth/0"}),this.ballotStore.motions.length==0&&this.loadMotions(),this.user==1&&(this.userMotion=!this.userMotion)},methods:{async loadMotions(){await this.ballotStore.loadMotions()||this.$q.notify({icon:"warning",color:"negative",message:this.$t("motion.load.failure")})},async userMotions(){await this.loadMotions();var e=[];this.userMotion?this.ballotStore.motions.forEach(l=>{var g;((g=this.authStore.user)==null?void 0:g.person.id)===l.added_by.id&&e.push(l)}):this.ballotStore.motions.forEach(l=>{e.push(l)}),this.ballotStore.motionList=e},onAddClick(){this.$q.dialog({title:this.$t("motion.add.title"),message:this.$t("motion.add.message"),prompt:{model:"",type:"text"},persistent:!1,ok:{flat:!0,color:"light-blue-13",label:this.$t("motion.add.button.ok")},cancel:{flat:!0,color:"orange-13",label:this.$t("motion.add.button.cancel")}}).onOk(async e=>{this.authStore.user!=null&&this.authStore.user.person==null&&(this.authStore.user.role.id=="1"||this.authStore.user.role.id=="2")?this.$q.dialog({title:this.$t("motion.add.warning.title"),message:this.$t("motion.add.warning.message"),ok:{flat:!0,color:"light-blue-13"}}):await this.ballotStore.createMotion(e)?this.$q.notify({icon:"done",color:"positive",message:this.$t("motion.add.success")}):this.$q.notify({icon:"warning",color:"negative",message:this.$t("motion.add.failure")})})},search(){return this.ballotStore.motions.filter(e=>e.name.toLowerCase().includes(this.searchInput.toLowerCase()))}},computed:{...D(H,O),mobileW(){return this.$q.platform.is.mobile?this.$q.screen.width:this.$q.screen.width/2},mobileH(){return this.$q.platform.is.mobile?(this.$q.screen.height-50)/1.5:this.$q.screen.height/2.2}}},de={key:1,id:"Motion Page"},ue={class:"row"},he={class:"text-h5 text-white text-center q-my-xs"},ce={class:"row justify-center q-my-md"};function me(e,l,g,C,L,c){const a=P("MotionPageSkeleton"),q=P("MotionList");return s(),b(S,null,[e.authStore.isLoading?(s(),i(a,{key:0})):u("",!0),e.authStore.isLoading?u("",!0):(s(),b("div",de,[t(Y,{class:n(["row justify-center items-center",{"bg-grey-9":e.$q.dark.isActive}]),style:{background:"linear-gradient(#f3f3f5, #b4b4b4)"}},{default:o(()=>[e.authStore.user!=null?(s(),b("div",{key:0,class:n({"q-pa-lg":!e.$q.platform.is.mobile})},[h("div",ue,[t(Q,{square:"",class:n({"shadow-24":!e.$q.dark.isActive}),style:k([{"min-height":"250px"},{minWidth:c.mobileW+"px",minHeight:c.mobileH*1.5+"px"}])},{default:o(()=>[t($,{class:n(["bg-dark",{"bg-black":e.$q.dark.isActive}])},{default:o(()=>[h("div",{class:n({"row justify-center":e.$q.screen.width>=650,"row justify-start":e.$q.screen.width<=650})},[h("h4",he,r(e.$t("motion.title")),1),t(J,{style:{bottom:"0",right:"18px",transform:"translateY(-15px)"},dark:"",dense:"",standout:"",modelValue:e.searchInput,"onUpdate:modelValue":l[1]||(l[1]=m=>e.searchInput=m),"input-class":"text-right",class:"q-ml-md absolute"},{append:o(()=>[e.searchInput===""?(s(),i(j,{key:0,name:"search"})):(s(),i(j,{key:1,name:"clear",class:"cursor-pointer",onClick:l[0]||(l[0]=m=>e.searchInput="")}))]),_:1},8,["modelValue"])],2)]),_:1},8,["class"]),t($,null,{default:o(()=>[t(N,{offset:250,style:k([{"max-width":"1000px",overflow:"auto"},{height:c.mobileH+"px"}]),class:n({"q-pa-md":!e.$q.platform.is.mobile})},{loading:o(()=>[h("div",ce,[e.ballotStore.isLoading?(s(),i(X,{key:0,color:"lime-6",size:"40px"})):(s(),i(G,{key:1}))])]),default:o(()=>[t(E,{separator:"",bordered:"",class:"rounded-borders"},{default:o(()=>[!e.ballotStore.isLoading&&e.ballotStore.motions.length==0?(s(),i(z,{key:0},{default:o(()=>[t(W,{class:"text-subtitle1"},{default:o(()=>[f(r(e.$t("motion.empty")),1)]),_:1})]),_:1})):(s(),i(q,{key:1,motionList:c.search()},null,8,["motionList"]))]),_:1})]),_:1},8,["style","class"])]),_:1}),t(M,null,{default:o(()=>[e.authStore.user.person!=null&&(e.authStore.user.role.id=="1"||e.authStore.user.role.id=="2")?(s(),i(K,{key:0,class:"q-pa-lg",modelValue:e.userMotion,"onUpdate:modelValue":l[2]||(l[2]=m=>e.userMotion=m),"checked-icon":"check","unchecked-icon":"clear",label:e.$t("motion.button.toggle"),"left-label":"",color:"light-blue-13",onClick:l[3]||(l[3]=m=>c.userMotions())},null,8,["modelValue","label"])):u("",!0),e.authStore.user.person!=null&&(e.authStore.user.role.id=="1"||e.authStore.user.role.id=="2")?(s(),i(w,{key:1,class:"absolute",style:{bottom:"0",right:"18px",transform:"translateY(-18px)"},fab:"",icon:"add",color:"orange-13",onClick:c.onAddClick},null,8,["onClick"])):u("",!0)]),_:1})]),_:1},8,["class","style"])])],2)):u("",!0)]),_:1},8,["class"])]))],64)}var Se=v(ne,[["render",me]]);export{Se as default};
