import{aB as B,U as e}from"./index.0f3dcf3a.js";const S=B("ballotStore",{state:()=>({motionList:[],ballotList:[],teamList:[],tournamentList:[],savedBallot:localStorage.getItem("ballot"),loading:!1}),getters:{motions:t=>t.motionList,ballots:t=>t.ballotList,teams:t=>t.teamList,tournaments:t=>t.tournamentList,isLoading:t=>t.loading,ballot:t=>t.savedBallot!=null?JSON.parse(t.savedBallot):null},actions:{async loadBallots(){this.loading=!0,this.ballotList=[];const t=e();try{this.api.defaults.headers.common.Authorization=t.token,(await this.api.get("ballot")).data.forEach(o=>{this.ballotList.push(o)})}catch{return this.loading=!1,!1}return this.loading=!1,!0},async loadAllBallots(){this.loading=!0,this.ballotList=[];const t=e();try{this.api.defaults.headers.common.Authorization=t.token,(await this.api.get("ballots")).data.forEach(o=>{this.ballotList.push(o)})}catch{return this.loading=!1,!1}return this.loading=!1,!0},async createOrUpdateBallot(t,a,o,s,i,n,l,r,h,d,c,m,f,p,g,w,y){this.loading=!0;const L=e(),u={Adjudicator:c,A1:m,A2:f,A3:p,N1:g,N2:w,N3:y};try{this.api.defaults.headers.common.Authorization=L.token,t===0?await this.api.post("ballot",{tournament:a.id,date:o,motion:s.id,team_AFF:i.id,team_NEG:n.id,decision:l,adj_winning_team:r.id,winning_team:h.id,adjucations:d,pivot:u}):await this.api.put("ballot/"+t,{tournament:a.id,date:o,motion:s.id,team_AFF:i.id,team_NEG:n.id,decision:l,adj_winning_team:r.id,winning_team:h.id,adjucations:d,pivot:u}),await this.loadBallots()}catch{return this.loading=!1,!1}return this.loading=!1,!0},async deleteBallot(t){this.loading=!0;const a=e();try{this.api.defaults.headers.common.Authorization=a.token,await this.api.delete("ballot/".concat(t.Ballot.id)),await this.loadBallots()}catch{return this.loading=!1,!1}return this.loading=!1,!0},async downloadBallotPDF(t){this.loading=!0;const a=e();try{this.api.defaults.headers.common.Authorization=a.token;const o=await this.api.get("ballot/pdf/".concat(t.Ballot.id),{responseType:"blob"}),s=document.createElement("a");s.href=window.URL.createObjectURL(new Blob([o.data])),s.setAttribute("download",t.Ballot.motion.name.concat(" - ",t.Ballot.tournament.name," - ",new Date(t.Ballot.date).toLocaleDateString(),".pdf")),document.body.appendChild(s),s.click(),await this.loadBallots()}catch{return this.loading=!1,!1}return this.loading=!1,!0},async loadTeams(){this.loading=!0,this.teamList=[];const t=e();try{this.api.defaults.headers.common.Authorization=t.token,(await this.api.get("teams")).data.forEach(o=>{this.teamList.push(o)})}catch{return this.loading=!1,!1}return this.loading=!1,!0},async loadTournaments(){this.loading=!0,this.tournamentList=[];const t=e();try{this.api.defaults.headers.common.Authorization=t.token,(await this.api.get("tournaments")).data.forEach(o=>{this.tournamentList.push(o)})}catch{return this.loading=!1,!1}return this.loading=!1,!0},async loadMotions(){this.loading=!0,this.motionList=[];const t=e();try{this.api.defaults.headers.common.Authorization=t.token,(await this.api.get("motion")).data.forEach(o=>{this.motionList.push(o)})}catch{return this.loading=!1,!1}return this.loading=!1,!0},async createMotion(t){this.loading=!0;const a=e();try{this.api.defaults.headers.common.Authorization=a.token,await this.api.post("motion",{name:t}),await this.loadMotions()}catch{return this.loading=!1,!1}return this.loading=!1,!0},async editMotion(t,a){this.loading=!0;const o=e();try{this.api.defaults.headers.common.Authorization=o.token,await this.api.put("motion/".concat(t.id),{name:a}),await this.loadMotions()}catch{return this.loading=!1,!1}return this.loading=!1,!0},async deleteMotion(t){this.loading=!0;const a=e();try{this.api.defaults.headers.common.Authorization=a.token,await this.api.delete("motion/".concat(t.id)),await this.loadMotions()}catch{return this.loading=!1,!1}return this.loading=!1,!0}}});export{S as u};
